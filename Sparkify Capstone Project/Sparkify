{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Sparkify Project Workspace\n",
    "This workspace contains a tiny subset (128MB) of the full dataset available (12GB). Feel free to use this workspace to build your project, or to explore a smaller subset with Spark before deploying your cluster on the cloud. Instructions for setting up your Spark cluster is included in the last lesson of the Extracurricular Spark Course content.\n",
    "\n",
    "You can follow the steps below to guide your data analysis and model building portion of this project."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [],
   "source": [
    "# import libraries\n",
    "import pandas as pd\n",
    "import datetime\n",
    "import seaborn as sns\n",
    "import matplotlib.pyplot as plt\n",
    "from pyspark.sql import SparkSession\n",
    "from pyspark.sql.functions import split, udf, isnull, min, max, sum as Fsum, avg, col, concat, desc, explode, lit, count \n",
    "from pyspark.sql.types import IntegerType, DateType\n",
    "from pyspark.ml import Pipeline\n",
    "from pyspark.ml.classification import  RandomForestClassifier,  NaiveBayes, LogisticRegression, DecisionTreeClassifier\n",
    "from pyspark.ml.evaluation import MulticlassClassificationEvaluator\n",
    "from pyspark.ml.feature import  StandardScaler, StopWordsRemover, CountVectorizer, IDF, VectorAssembler, Normalizer, PCA, RegexTokenizer, StringIndexer\n",
    "from pyspark.ml.regression import LinearRegression\n",
    "from pyspark.ml.tuning import  ParamGridBuilder, CrossValidator     "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [],
   "source": [
    "# create a Spark session\n",
    "sparkBuilder = SparkSession.builder\n",
    "spark = sparkBuilder.master(\"local\").appName(\"Spark\").getOrCreate()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Load and Clean Dataset\n",
    "In this workspace, the mini-dataset file is `mini_sparkify_event_data.json`. Load and clean the dataset, checking for invalid or missing data - for example, records without userids or sessionids. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [],
   "source": [
    "# load mini_sparkify_event_data (json file) and read it\n",
    "sparkDf = spark.read.json('mini_sparkify_event_data.json')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Checking dataset"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Details of dataset"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "DataFrame[summary: string, artist: string, auth: string, firstName: string, gender: string, itemInSession: string, lastName: string, length: string, level: string, location: string, method: string, page: string, registration: string, sessionId: string, song: string, status: string, ts: string, userAgent: string, userId: string]"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# general details\n",
    "sparkDf.describe()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Row(artist='Martha Tilston', auth='Logged In', firstName='Colin', gender='M', itemInSession=50, lastName='Freeman', length=277.89016, level='paid', location='Bakersfield, CA', method='PUT', page='NextSong', registration=1538173362000, sessionId=29, song='Rockpools', status=200, ts=1538352117000, userAgent='Mozilla/5.0 (Windows NT 6.1; WOW64; rv:31.0) Gecko/20100101 Firefox/31.0', userId='30')"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# top five rows\n",
    "sparkDf.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "root\n",
      " |-- artist: string (nullable = true)\n",
      " |-- auth: string (nullable = true)\n",
      " |-- firstName: string (nullable = true)\n",
      " |-- gender: string (nullable = true)\n",
      " |-- itemInSession: long (nullable = true)\n",
      " |-- lastName: string (nullable = true)\n",
      " |-- length: double (nullable = true)\n",
      " |-- level: string (nullable = true)\n",
      " |-- location: string (nullable = true)\n",
      " |-- method: string (nullable = true)\n",
      " |-- page: string (nullable = true)\n",
      " |-- registration: long (nullable = true)\n",
      " |-- sessionId: long (nullable = true)\n",
      " |-- song: string (nullable = true)\n",
      " |-- status: long (nullable = true)\n",
      " |-- ts: long (nullable = true)\n",
      " |-- userAgent: string (nullable = true)\n",
      " |-- userId: string (nullable = true)\n",
      "\n"
     ]
    }
   ],
   "source": [
    "# prints out the schema in the tree format\n",
    "sparkDf.printSchema()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Clean the dataset"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Delete rows containing missing values and rows that have an empty userid\n",
    "sparkDf = sparkDf.dropna(how = \"any\", subset = [\"userId\", \"sessionId\"]).filter(sparkDf.userId != \"\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Exploratory Data Analysis\n",
    "When you're working with the full dataset, perform EDA by loading a small subset of the data and doing basic manipulations within Spark. In this workspace, you are already provided a small subset of data you can explore.\n",
    "\n",
    "### Define Churn\n",
    "\n",
    "Once you've done some preliminary analysis, create a column `Churn` to use as the label for your model. I suggest using the `Cancellation Confirmation` events to define your churn, which happen for both paid and free users. As a bonus task, you can also look into the `Downgrade` events.\n",
    "\n",
    "### Explore Data\n",
    "Once you've defined churn, perform some exploratory data analysis to observe the behavior for users who stayed vs users who churned. You can start by exploring aggregates on these two groups of users, observing how much of a specific action they experienced per a certain time unit or number of songs played."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [],
   "source": [
    "# the churn users\n",
    "data = sparkDf.filter(sparkDf.page==\"Cancellation Confirmation\").select(\"userId\").dropDuplicates()\n",
    "itsChurn = sparkDf.withColumn(\"churn\", sparkDf.userId.isin( [x[\"userId\"] for x in data.collect()]))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<AxesSubplot:xlabel='churn', ylabel='count'>"
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAl4AAAHgCAYAAAB0CWMeAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjUuMSwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/YYfK9AAAACXBIWXMAAAsTAAALEwEAmpwYAAAYJElEQVR4nO3df/BldX3f8debXy4/jChsCbBJdq2UuJQfwvoTRYJafwQBM6hQKRic2c4YRWttNdWZ2Dp2YockZZJOLBWVZBQQEFBMmjoIcRRLAF0UFmj8gXGdFdaNNllldXf59I+90BV34St+7/v7g8djZud7z7nnnPv+/nPnueec7701xggAANO321wPAADweCG8AACaCC8AgCbCCwCgifACAGgivAAAmuwx1wPMxIEHHjiWL18+12MAADyqW2+99XtjjKU7e25BhNfy5ctzyy23zPUYAACPqqq+tavnXGoEAGgivAAAmggvAIAmC+IeLwBg8duyZUvWrVuXzZs3z/UoM7JkyZIsW7Yse+6554z3EV4AwLywbt26PPGJT8zy5ctTVXM9ziMaY2Tjxo1Zt25dVqxYMeP9XGoEAOaFzZs354ADDpj30ZUkVZUDDjjg5z47J7wAgHljIUTXgx7LrMILAHjcef3rX58rrrii/XWFFwDAo9i6deusHEd4AQDz2nvf+94cfvjhef7zn58zzzwz559/fr7+9a/nZS97WY477ri84AUvyF133ZVk+5ms8847L8973vPy1Kc+9aGzWmOMvOlNb8rhhx+eF7/4xbnvvvseOv6tt96aF77whTnuuOPy0pe+NOvXr0+SnHjiiXnrW9+aVatW5YILLpiV38VfNQIA89bNN9+cK6+8Mrfddlu2bNmSY489Nscdd1xWr16dD3zgAznssMNy00035Y1vfGM++9nPJknWr1+fz3/+87nrrrtyyimn5PTTT89VV12Vu+++O2vXrs29996blStX5txzz82WLVvy5je/Oddcc02WLl2ayy67LO9617vyoQ99KEnyk5/8ZFa/tlB4AQDz1he+8IWceuqpWbJkSZYsWZJXvvKV2bx5c2688ca8+tWvfmi7H//4xw89Pu2007Lbbrtl5cqVuffee5Mkn/vc53LmmWdm9913zyGHHJKTTjopSXL33Xfn9ttvz0te8pIkybZt23LwwQc/dKzXvva1s/r7CC8AYEF54IEHsv/++2fNmjU7ff4JT3jCQ4/HGI94rDFGjjjiiHzxi1/c6fP77rvvY55zZ9zjBQDMW8cff3w+9alPZfPmzdm0aVOuvfba7LPPPlmxYkUuv/zyJNvj6bbbbnvE45xwwgm57LLLsm3btqxfvz7XX399kuTwww/Phg0bHgqvLVu25I477pja7yO8AIB565nPfGZOOeWUHHXUUXn5y1+eI488Mk960pPy0Y9+NBdddFGOPvroHHHEEbnmmmse8TivetWrcthhh2XlypU5++yz89znPjdJstdee+WKK67IO97xjhx99NE55phjcuONN07t96lHOwU3H6xatWrM5o1tAMD8c+edd+bpT3/6z6zftGlT9ttvv/zoRz/KCSeckAsvvDDHHnvsHEz4s3Y2c1XdOsZYtbPt3eMFAMxrq1evztq1a7N58+acc8458ya6HgvhBQDMax/72MfmeoRZ4x4vAIAmznjtxLVf/uZcj8BjdPIzVsz1CACwS854AQA0EV4AAE2EFwDARFXlrLPOemh569atWbp0aU4++eRZOb57vACAeWm277meyX3A++67b26//fbcf//92XvvvfOZz3wmhx566KzN4IwXAMAOXvGKV+TTn/50kuSSSy7JmWeeOWvHFl4AADs444wzcumll2bz5s35yle+kmc/+9mzdmzhBQCwg6OOOir33HNPLrnkkrziFa+Y1WO7xwsA4GFOOeWUvP3tb88NN9yQjRs3ztpxhRcAwMOce+652X///XPkkUfmhhtumLXjutQIAPAwy5Yty3nnnTfrx3XGCwCYl+bia+A2bdr0M+tOPPHEnHjiibNyfGe8AACaCC8AgCbCCwCgifACAGgivAAAmggvAIAmPk4CAGBi9913z5FHHvnQ8tVXX53ly5fP2vGFFwAwL738fVfP6vH+8l2nPeo2e++9d9asWTOrr7sjlxoBAJo44wUAMHH//ffnmGOOSZKsWLEiV1111aweX3gBAExM+1Kj8GJRme37Aeg1k/svABYy93gBADQRXgAATVxqBADmpbm4/WDTpk1TPb4zXgAATYQXAEAT4QUA0ER4AQDzxhhjrkeYsccyq/ACAOaFJUuWZOPGjQsivsYY2bhxY5YsWfJz7eevGgGAeWHZsmVZt25dNmzYMNejzMiSJUuybNmyn2sf4QUAzAt77rlnVqxYMddjTJVL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\n",
      "text/plain": [
       "<Figure size 720x576 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# the users who is Male and churn (M - True) and Male and not churn (M - False)\n",
    "# also who is Famle and churn (F - True) and Famle and not churn (F - False)\n",
    "churnGenderDf = itsChurn.dropDuplicates([\"userId\", \"gender\"]).groupby([\"churn\", \"gender\"])\n",
    "churnGender = churnGenderDf.count().sort(\"churn\").toPandas()\n",
    "fig, ax = plt.subplots(figsize=(10, 8))\n",
    "sns.barplot(x='churn', y='count',ax=ax, hue='gender', data=churnGender, palette = \"Blues\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<AxesSubplot:ylabel='page'>"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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r17cd999HHXUUQBsvfXW3HfffZx44olcfvnlHfYMbeVkJRuOAX4fEX0joiYi+gAvAAcCDwJfAZA0CBic2jwGfEbS1pIqgC8VKZa7gdPrEyVJe7ZQv6PiMDOzAg899BBHHHEEW2+9NZBPOAC+8IUvsNFGG9G/f38WL17cqr5GjBixzvmhhx4KwB577MHf//734gVdJE5WsmEkMLlB2S2p/AqgStIzwDnkl4aIiNeBccAjwMPAMxTHz8gvxc6VND+dN6kD4zAzs1bo3r372uOIAKBbt26sWbNmbfmKFeu+97Dpppuuc16/vNWtWzdWr17dUaG2mafxMyAihjdSVvi5J8c10e535N8Uaq7vicDEBmXjGpzngFw6Xgac0lI/EXHY+sTRkLpXlvVehyx4LpfzGJp1IQcccACjRo3i1FNPZauttuKdd95psm6fPn149tlnWbFiBcuXL2f69Onsu+++GzDa4nKyYmZm1gaVbXjVuClLliyhsoU6AwYM4IwzzmDEiBFstNFGfPKTn2yy7g477MARRxzBQQcdxE477cSgQYOKFmspqH7KyGxD6t+/fyxc6FeX26MrvYXRUTyG7deVxrDh20DFtGTJkla9DdSZfPDBB+ywww7rlEmaFREf+ZR271kxMzOzTHOyYmZmZpnmZMXMzMwyzcmKmZmZZZqTFTMzM8s0JytmZmaWaf6cFTMzszb44sR5Re3vrlFNf25KW91www3U1tbysY99rFX1G34BYlZ4ZsXMzKyTuuGGG3jjjTc22P1WrVrVIf16ZsVKYvmqNex94f1tajtj7MFFjsbMLPv+/ve/M3LkSPbdd19mzJjBxz72Ma699lp69OjBvHnz+MEPfsD7779PTU0NF198MdOnT2fOnDl885vfpLKykrvuuosePXqs7e/5559n7NixvP3223Tr1o0JEyYAsHTpUkaPHs2CBQsYPHgwV1xxBZIYOnQoU6dOZeutt2bOnDmMGzeOP/3pT/ziF7/gxRdf5KWXXmLHHXdk55135tVXX+Wll17ilVde4ZRTTuHkk09u17N7ZsXMzKxMPP/883z9619n+vTpbLnlltx5550AnHbaafzkJz9h2rRpDBw4kIsuuojDDz+cIUOGcMUVV/DAAw+sk6gA/Od//iejR48ml8sxZcoUtt12WwDmzZvHz3/+cx566CFeeuklHnvssRbjevbZ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\n",
      "text/plain": [
       "<Figure size 504x504 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# the frequent of churn and not churn\n",
    "\n",
    "cSongPage = itsChurn.filter(itsChurn.churn==1).filter(itsChurn.page!=\"NextSong\").groupby([\"page\"]).count()\n",
    "\n",
    "cSongPageNot = itsChurn.filter( itsChurn.churn==0).filter(itsChurn.page!=\"NextSong\").groupby([\"page\"]).count()\n",
    "\n",
    "SongPageNChurnS = cSongPageNot.withColumn(\"not churn\", cSongPageNot[\"count\"]/(itsChurn.filter(itsChurn.churn==0).count()/100)).sort(\"page\")\n",
    "dropDupDf = cSongPage.withColumn(\"churn\",cSongPage[\"count\"]/ (itsChurn.filter(itsChurn.churn==1).count()/100)).sort(\"page\")\\\n",
    " .join(SongPageNChurnS, \"page\", \"outer\").drop(\"count\").fillna(0).toPandas()\n",
    "\n",
    "fig, ax = plt.subplots(figsize=(7, 7))\n",
    "plt.style.use('ggplot') \n",
    "dropDupDf.plot(\"page\", kind=\"barh\", ax=ax)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<AxesSubplot:xlabel='level', ylabel='count'>"
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAbkAAAGsCAYAAABAT9kAAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjUuMSwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/YYfK9AAAACXBIWXMAAAsTAAALEwEAmpwYAAAX/klEQVR4nO3df2zUhf3H8de1lF8j/V2Y18JiIa4rwhRafisIJzPg1zV8AUeiE4kpP5QFIky+ZsCSAR6xTQmh6IhFXGZCMSaIzqE7mDCq00bCuuGCEiGbA2mPlvLDltq7z/cPtosdVQ+4fj7l3efjr97n7nOf9yV3febzubvP+RzHcQQAgEFJXg8AAEBXIXIAALOIHADALCIHADCLyAEAzCJyAACzenk9wPU4deqU1yMAALoRv9/f6XL25AAAZhE5AIBZRA4AYBaRAwCYReQAAGYROQCAWUQOAGAWkQMAmEXkAABmETkAgFlEDgBgFpEDAJhF5AAAZhE5AIBZRA4AYBaRAwCYdVP+aCqAxJv/0ntej4AeZMcj413ZDntyAACziBwAwCwiBwAwi8gBAMwicgAAs4gcAMAsIgcAMIvIAQDMcuXL4G1tbVq7dq3a29sViUQ0btw4zZ07V/X19dq0aZMuXLig/Px8LV26VL168f10AEBiuFKUlJQUrV27Vn379lV7e7vWrFmjO+64Q2+88YZmzpypiRMnatu2bdq/f7+mT5/uxkgAgB7AlcOVPp9Pffv2lSRFIhFFIhH5fD4dPXpU48aNkyRNmTJFtbW1bowDAOghXDs2GI1G9dRTT+nzzz/Xj370Iw0aNEj9+/dXcnKyJCkzM1ONjY2drhsKhRQKhSRJwWBQ2dnZbo0NAOgCbv0fdy1ySUlJevbZZ3Xp0iWVlZXp1KlTca8bCAQUCARil8PhcFeMCABwSaL/j/v9/k6Xu/7pyu985zsaPny4Pv74Y33xxReKRCKSpMbGRmVmZro9DgDAMFcid/78eV26dEnSlU9a1tXVKTc3V8OHD9ef//xnSdI777yjoqIiN8YBAPQQrhyubGpqUmVlpaLRqBzH0fjx4zV69Gjl5eVp06ZN2rlzp2699VZNnTrVjXEAAD2Ez3Ecx+shrtW1vJ8HID78aCrclOgfTe0278kBAOAWIgcAMIvIAQDMInIAALOIHADALCIHADCLyAEAzCJyAACziBwAwCwiBwAwi8gBAMwicgAAs4gcAMAsIgcAMIvIAQDMInIAALOIHADALCIHADCLyAEAzCJyAACziBwAwCwiBwAwi8gBAMwicgAAs4gcAMAsIgcAMIvIAQDMInIAALOIHADALCIHADCLyAEAzCJyAACziBwAwCwiBwAwi8gBAMwicgAAs4gcAMAsIgcAMIvIAQDMInIAALOIHADALCIHADCLyAEAzCJyAACziBwAwCwiBwAwi8gBAMwicgAAs4gcAMCsXm5sJBwOq7KyUufOnZPP51MgENCMGTO0a9cu7du3T6mpqZKkefPmadSoUW6MBADoAVyJXHJysh5++GHl5+erpaVFq1at0siRIyVJM2fO1AMPPODGGACAHsaVyGVkZCgjI0OS1K9fP+Xm5qqxsdGNTQMAejDX35Orr6/XiRMnNGzYMEnSW2+9pRUrVmjr1q26ePGi2+MAAAzzOY7juLWx1tZWrV27VrNmzdLYsWN17ty52Ptx1dXVampq0pIlS65aLxQKKRQKSZKCwaDa2trcGhnoMe4vf93rEdCDvPHk/yT0/nr37t3pclcOV0pSe3u7ysvLddddd2ns2LGSpPT09Nj106ZN08aNGztdNxAIKBAIxC6Hw+EunRUA0LUS/X/c7/d3utyVw5WO4+j5559Xbm6u7r///tjypqam2N8ffPCBBg8e7MY4AIAewpU9uWPHjungwYMaMmSIVq5cKenK1wVqamp08uRJ+Xw+5eTkqLS01I1xAAA9hCuRKygo0K5du65aznfiAABdiTOeAADMInIAALOIHADALCIHADCLyAEAzCJyAACziBwAwCwiBwAwi8gBAMwicgAAs4gcAMAsIgcAMIvIAQDMInIAALOIHADALCIHADCLyAEAzCJyAACziBwAwCwiBwAwi8gBAMwicgAAs4gcAMAsIgcAMIvIAQDMInIAALOIHADALCIHADCLyAEAzCJyAACziBwAwCwiBwAwi8gBAMwicgAAs4gcAMAsIgcAMIvIAQDMInIAALOIHADALCIHADCLyAEAzOrl9QBeOr3yMa9HQA9zy7MveD0C0KOwJwcAMIvIAQDMInIAALOIHADALCIHADCLyAEAzCJyAACziBwAwCxXvgweDodVWVmpc+fOyefzKRAIaMaMGbp48aIqKirU0NCgnJwcLV++XAMGDHBjJABAD+BK5JKTk/Xw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\n",
      "text/plain": [
       "<Figure size 504x504 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# the number of cancellation confirmation for each free and paid users\n",
    "data = itsChurn.filter(itsChurn.page == \"Cancellation Confirmation\").groupby(\"level\").count().toPandas()\n",
    "fig, ax = plt.subplots(figsize=(7, 7))\n",
    "plt.style.use('ggplot') \n",
    "sns.barplot(x=\"level\", y=\"count\", ax=ax, data=data)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "<ipython-input-20-7488b1ddb31e>:5: UserWarning: To output multiple subplots, the figure containing the passed axes is being cleared.\n",
      "  Songs.hist(['SongsPlayed'], ax=ax, by='churn',density=5)\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "[]"
      ]
     },
     "execution_count": 20,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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LycnRxaLJcaVTS/eR0RbvM+JR48eDfv7mD9/fkzrweTE4xwWr19oZmI+NDrgffOb39Tdd98tuz18Q+XQ0JCqq6u1bdu2GFU2fZ566in993//ty644ILQhN3X16d9+/bp6quv1uWXXx7jCj+c5557Tvfff79OP/30sPG99tpr+upXv6oLL7wwxhVOD95HM97HeBevc+LBgwe1Y8cODQwMhP19JCcna9WqVTr77LNjUpdEaIlUPM5h8fqFZqbmQ6N30VosFh05ckQLFiwIe/zIkSPGbDV4+OGHVVtbO2KyOXbsmGpqamZ9MPjJT36i7373u0pPTw973Ofz6c4771RdXV2MKptevI9mvI/xLl7nxO3bt2v16tXKzc0Ne/wf//iH7r33Xt11110xqWu00NLV1aVf/OIXcRFacnJyJJ0ILVu3bo1paInHOezJJ58c9QvNVVddperq6pj9rmZqPjQ64F1//fW64447dPrpp4du4n348GG99tprWrVqVYyrmz6jTcxWq1UmbJwdHh4OuwH7exwOh4aGhmJQUfTwPiLa4nVOfPfdd0eEO0k655xz9M4778SgohMILZMTb3NYvH6hman50OiAl5+fr61bt466n/u9K8fPdp/73Od0yy236IILLgibsPft26fPf/7zMa7uwysuLta6devkdruVlpYm6cT4vF6vUVfz533ETIjXOTE/P1933nmnLr/88tDff19fn5566inl5+fHrC6J0BKpeJzD4vULzUzNh0Yfg3eyOHbsmJ577rkRx4ikpKTEuLLp0dPTo46Ojrg63iQaeB9xMvvLX/4y6nFlBQUFMauptbVVv/rVr8YMLUVFRTNeU2dnpxobG8cMLbEMxPE4hwUCgbj7QiPNzHxIwDPEyXD22bFjxyTJmMAzGt5HIL4QWiYn3uaweD97P5rzodG7aE8G8Xz22XQ4fPiwHnjgAXV1dSkpKUnBYFBvv/22PvrRj+raa68dcZDqbMX7aMb7iKkZGBhQc3OzOjo6dPToUVksFs2bN08ul0vl5eUxPWM1JSVFeXl5YQEh1l9OLBZL6L/3L8dSPM5h8Xr2/kzNh2zBm+W+/e1vj3n22Y4dO2J29tl0qamp0bJly1RYWBj6dhoIBPT000/rscce08aNG2Nc4fTgfTTjfcTUbNy4UXl5eSoqKgpt8Tl69KhaW1vV1dWl2267LSZ1EVoiF49z2Nq1a7Vu3bq4O3t/puZDtuDNcvF69tl06e/vl9vtDnvMarXq0ksv1e7du2NU1fTjfcTJzOfzqaamJuyx+fPnq7y8XE8++WSMqorPy7fE6yWH4nEOi9ez92dqPiTgzXLxfPbZdDj77LN1//33jzq+M888M7bFTSPeR5zMFixYoF//+te6/PLLR2zBe+8sw1ggtEQuHueweD17f6bmQ3bRGiAezz6bLkNDQ/J4PKOOr6SkRAkJCTGucPrwPuJkdezYMe3Zs0cdHR164403JJ3YgrdkyRKVl5fH7Ji3nTt36tChQ6N+EKenp8fkUhvNzc16+umnRw0tS5cu1ec+97kZr+k98TiHxePZ+zM1HxLwAABx5f/+7//U3d2tj3zkIzG/jR2hBbMVAW+Wi+ezz6bD8PDwuN90Png199mK99GM9xFTs27dOt15552SpCeeeEK//e1vddFFF+n5558PbcVDfIvHOayzszO0e3hgYEA/+9nP1N3draysLH3lK1+J2SVcZmo+JODNcvF69tl02bJli5KTk0fdRXLs2DGtXbs2xhVOD95HM95HTM13vvMd/ehHP5J0IuytW7dOc+fO1TvvvKOamhrdfffdMamL0BK5eJzDbrnlFv3whz+UJP3Xf/2X5s+fr9LSUj3zzDN64YUX9J3vfGfGa5Jmbj6M/VUR8aH4fD6Vl5eH/aN+7+yz119/PXaFTZN//vOfuuGGG3TOOefI6XTK6XTqnHPO0Q033KCDBw/Gurxpw/uIk1kwGNSxY8fU39+vYDCouXPnSpLmzJkjm80Ws7rq6uqUnJys73//+2pqatLOnTv1/e9/X8nJyTE7W/UXv/hF6Oef/exnmj9/vm655RZlZ2frxz/+cUxqkuJ/DnvxxRd1zTXXaMGCBbrqqqtiWtNMzYcEvFnuvbPPjh49Gnrs6NGj2rNnT0zPPpsuKSkpevrppxUIBEKPBQIBeb3eWb/b8v14H3EyGxgY0K233qpbb71Vx44d05EjRyRJ77zzTszu+SoRWiYjHuewN954Q//zP/+j3/zmN3r77bfD/pZi+Xc1U/Mhu2hnuXg9+2y6+Hw+7dq1S11dXUpJSVEwGNTAwIDy8vL0xS9+0Zg7IJws7+Nf//rX0AT21ltvGfc+Ynq9++67euONN2L29/GDH/xAH/vYx0a9fMu+ffv03e9+d8ZrWrNmja666ioFg0H99re/VX19feguFt/61re0adOmGa9Jis857KGHHgpb/vSnP625c+fq6NGjeuCBB/SNb3xjxmuSZm4+JOAZ4JVXXlFfX5/OOecczZkzJ/T4+4/VMEF/f78kqampSTfffHOMq5le+/fv16JFi5SUlKR3331Xe/bs0T//+U8tXrxYFRUVSkpKinWJH8rQ0JD++Mc/yuFw6KyzzlJnZ6f+/ve/a/HixSorK+MkC8QlQsvkxONn0SuvvCK/36/c3Ny4qUk6MedbLBZlZGTolVde0T/+8Q8tXrx4Ws/OJuDNco899ph++9vfatGiRXrppZd0/fXX66KLLpIUfoDpbDVa/V1dXfroRz8q6cQYTVBdXa277rpLNptN9913n0455RQVFhZq3759eumll/Stb30r1iV+KNu2bdPw8LCOHz8eCrEXX3yx9u3bp2AwGNMPJWAqnnzySRUXF8e6jDCxrCkeP4v+93//V48//nhc1SSdCOmdnZ0aHh7WBRdcoO7ubp1//vnat2+fLrzwQlVUVEzL6/C1eZZ74okn9MMf/lBz5syRz+fT5s2b9frrr+vKK6+M6TEG08Xv92vRokUqLS2VxWJRMBjUiy++qM985jOxLm1aBYPB0MHkBw4cCE085557rr797W/HsrRp8fLLL2vTpk0aHh7WmjVrdN9998lqteqyyy4zYnw4+fzyl7+Mu4AXy5ri8bOopaUl7mqSpLa2Nt11110aHBzU6tWrde+99yopKUmf/exntX79egIeTggGg6HNzunp6br99tt199136/XXXzci4N1555167LHH9PDDD+u6667TmWeeqcTERJ1//vmxLm1aZWVlhb59n3HGGXrxxReVnZ2tV1991Yjdl8FgUENDQ3rnnXf07rvvamBgQCkpKRocHNTw8HCsywNGNdaW82AwGNplO9Pisab3Xj/ePovisSZJstlsslqtOuWUU5SRkRE6BCcxMTF0POV0mP2fHCe5efPm6eDBg6H7182ZM0e33nqr7r33Xr388suxLW4aWK1WXXXVVVq6dKl++tOfat68eUYGgjVr1qipqUkPP/ywUlNTddttt4VOn7/xxhtjXd6HVlxcrKqqKgUCAV1zzTXavHmz0tPTtX///hE33QbixRtvvKGampoRZzYGg8GYnGARrzVJ8flZFI81SZLdbte7776rU045RbW1taHHBwYGZLVO38VNOAZvluvr65PNZhv14pZ/+9vfdO655858UVH07LPP6m9/+5uuvfbaWJcSFQMDA/L5fAoEAnI4HDG7aGk0vP+K7W+99Zb27duntLQ05eTkxLgyYHT33nuviouLR51Ht27dqm9+85vU9P/F42dRPNYkSYODg6Peb/bNN9/U0aNH9ZGPfGRaXoeABwAAYBgudAwAAGAYAh4AAIBhCHgAAACGIeABAAAYhoAHAABgmP8HU6ROoJW/DyIAAAAASUVORK5CYII=\n",
      "text/plain": [
       "<Figure size 720x504 with 2 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "Songs = itsChurn.where(itsChurn.song!='null').groupby(['churn','userId']).agg(count(itsChurn.song)\\\n",
    "                                            .alias('SongsPlayed')).orderBy('churn').toPandas()\n",
    "fig, ax = plt.subplots(figsize=(10, 7))\n",
    "plt.style.use('ggplot') \n",
    "Songs.hist(['SongsPlayed'], ax=ax, by='churn',density=5)\n",
    "plt.plot()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "<ipython-input-21-3d5533b4767e>:6: UserWarning: To output multiple subplots, the figure containing the passed axes is being cleared.\n",
      "  thumbsUp.hist('ThumbsUps', by='churn', color = \"purple\", bins=20, ax=ax, density=5)\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "array([<AxesSubplot:title={'center':'False'}>,\n",
       "       <AxesSubplot:title={'center':'True'}>], dtype=object)"
      ]
     },
     "execution_count": 21,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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n88XnMcDpCPH6dOnQ75UrrjiivAWNA7Onj0rSUpISAhzJeNjqvVzOWKbCFw+jN8T98orr2jnzp2y2UJbufPOO1VWVmb0BmuqhJ63335be/fuVU9PT/BLxev1Kj4+XuvXr9fcuXPDXOHYdHV16Yc//KGOHDmi+Ph4BQIBnTt3TosWLdLdd9+t5OTkcJc4JlOtn8tdJG0TW1tblZWVJUnq6enRc889p7feekvp6en60pe+NKnbtJ6eHu3fv19ut1tnzpyRxWLRzJkz5XQ6VVRUpPj4+EmrJZI+lwtF4nfO+fPn9ec//1kpKSmT+jv6WCAQkMfjCflc5s2bJ4vFMum1DMX4EGexWHTq1CldeeWVIfNPnToVMR/yWE210FNbW6t7771X8+fPD5l/7Ngxffvb39aTTz4ZpsouTlVVlVasWKHNmzcH7+/l9/v161//Wrt27VJ5eXmYKxybqdbP5S6Ston/+Z//GQwrP/jBDzRr1ixt2bJFr776qr773e/qX//1XyetlqqqKmVmZmrHjh3BcHL69GkdPHhQVVVV2r59+6TVEkmfixRZ3znPPvus7rnnHknS73//e+3atUupqak6efKkNmzYoOzs7Emr5Y033tCzzz6rq666KuRzOXnypO655x7deOONk1bLcIwPcWvWrNGjjz6qq666Kvjw6K6uLp08eVLr168Pc3UXZ6qFng8//HBQL5K0YMECnT9/PgwVXZru7m7l5OSEzIuKitLNN9+sffv2hamqizfV+rncReo28a233gpuu+6880798pe/nNT37+zs1LZt20LmXXHFFSoqKtIrr7wyqbVcKNyfixRZ3znHjx8P/rxv3z597Wtf09y5c/Xee++pqqpqUkPc97//fX39618fdDSis7NTjz/+uKqqqiatluEYH+KysrK0a9euIXd3frxXwTRTLfRkZWXp8ccf12233Rb8UvF6vfrlL38Z/GvUJHPnztWzzz47ZD/XXHNNeIu7CFOtn8tdJG0Tz5w5o5/85CfBQ/SBQCC4N3CyT8e+8sor9V//9V+67bbbBu2JS0pKmtRaIulzkSL3O6enpye4FzAlJWXSP5uBgYHgNvFCdrtd/f39k1rLcIwPcdJHew0WLFgQ7jLGzVQLPevWrdNvfvObQVfLffazn53Uv6rGy/3336+mpiY9//zzg67+y8/PD3N1YzfV+kHkbBMLCgp07tw5SdJtt92m7u5uzZgxQ6dPn570PxBKS0t14MAB7dixQ2fOnJH00Z64JUuW6MEHH5zUWiLpc5Ei6zvnxIkT+upXv6pAIKD3339fZ8+eVUJCgvx+/6QHp7y8PD388MPKyckJBv2uri65XK6I2TYaf3XqVDVU6HE6nUaGHgCXrxMnTsjn82n+/PmKjY0Nzr/w5P5w+N3vfiePx6Orr7560s9teumll3TTTTdN+h7ATxIp3znvv/9+yPSsWbNks9n0l7/8Rb/73e+0dOnSSa2nvb1dLS0tEXu7HkIcJtzHV4W1tLTo9OnTYb0qbDwMDAyoqalpyA1efn7+oKsCI91U6weR46c//al+9rOfKS0tTX/605+0Zs0affrTn5YkbdmyRU888cSk1fLwww/r8ccflyS9/PLL+vnPf65Pf/rTevPNN7VkyZJJvWr3S1/6kmJjY5WSkqKbb75Zy5cv14wZMybt/TF1sHWOQFMt9Hx8VdgjjzwS9qvCxkN1dbXi4+P1D//wD4MOPVRXV0/6oZlLNdX6QeRobGzUE088odjYWHV2dqqyslLvv/++Pv/5z4fl/KYL69q+fbtmzJihu+66S9u2bZvUEJeSkqKKigodOXJELpdLzz//vObOnaubb75ZS5cu1fTp0yetFimyvnN6enp04MABeb1eLV68WLfcckvwtQuvXJ0Mf30rmB/84AfyeDxhvxXMhQhxEWiqhZ5IvSrsYv3xj3/Url27QuY5HA4tWLBADzzwQJiqunhTrR9EjkAgEDyEmpycrB07dmjnzp16//33Jz3EBQIBnT17VoFAQIFAILjnKzY2VlardVJrsVgsioqK0o033qgbb7xR/f39am1t1a9+9Sv9x3/8h+rq6ia1nkj6ztmzZ4+uuuoqLV26VK+88oqam5v1wAMPKDo6OuTK1cnw17eCueKKK8J6K5ihmHn55hTX2dmpoqKikJT/cej56/MFTPDxVWGnT58Ozjt9+rQOHDgQUeeEjFZCQoJ+/etfy+/3B+f5/X65XC7j9pJKU68fRI6ZM2fq7bffDk7HxsbqoYceUnd3t955551JraWnp0cPPfSQHnroIZ09e1anTp2S9NHNZMMRKC9ks9nkdDpVWlqqPXv2TGotUmR957z33nv64he/qJtuuklbtmzR3Llz9eijj6q7u3tS6/hrb731llatWqUrr7xSd955Z8R8F7MnLgJF0qXw4yGSrgobDw888IAaGhpUV1cXDDkffPCBMjMzVVpaGt7iLsLH/Tz77LNKSEhQIBBQT0+Psf0gctx///2D9nJZrVbdf//9KiwsnNRaamtrh5xvsVj0ta99bVJr+aT/X02bNm3yCvk/kfSd09/fL7/fH7wdTnFxsex2ux555JFJv91JpN0KZihc2BCBzp49qwMHDqilpWVQ6CkqKjLyuZYnTpyQ1+vVggULIuoKtYt1/PhxWSwWpaSk6MSJEzp27JjmzJlj/NXDH/+1W19fr82bN4e5GgCTIZK+c374wx/qhhtu0A033BAyv7W1Vd/73ve0e/fuSavlxz/+ccj0Zz/72eCtYH74wx/q/vvvn7RahkOIM8wrr7yivLy8cJcxJi+99JJ+/vOfR8QVauPhxz/+sVpbWzUwMKAbbrhBHo9H1113nY4cOaIbb7xRxcXF4S5xTIb6/I8ePapFixZJ+uh3BODyFEnfOdQyGIdTDfP8889HxD+csXj55Zcj5gq18dDc3Kwnn3xSfX19uvfee/Xtb39bcXFx+ru/+ztt3brVuBDn8/mUlpamgoICWSwWBQIBvfXWW7rrrrvCXRqAMIuk7xxqGYwQF4G++tWvDjk/EAgEd3WbJJKuUBsPVqtVUVFRmjZtmlJSUhQXFydJiomJmfQHjI+Hxx9/XC+99JJefPFFrV69Wtdcc41iYmJ03XXXhbs0AJMgkr5zqGVsCHER6MyZM9q2bdugKwMDgYC+/vWvh6mqi/fxFWofP07m4yvUvv3tb0/6FWrjwWaz6cMPP9S0adNUUVERnN/T02Pk83qjoqJ05513avny5Xruuec0c+bMkHtqAZjaIuk7h1rGhhAXgbKzs3X+/Pkhn6Fn4t6RSLpCbTx84xvfUHR0tCSFhLb+/n5t3LgxXGVdMofDobKyMr3++uuTfrNRAOETSd851DI2XNgAAABgIPOO/QAAAIAQBwAAYCJCHAAAgIEIcQAAAAYixAEAABjo/wFnpSKZGFJMxgAAAABJRU5ErkJggg==\n",
      "text/plain": [
       "<Figure size 720x504 with 2 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# the average of ThumpsUp group and ThumpsDown group\n",
    "thumbsUp = itsChurn.where(itsChurn.page =='Thumbs Up').groupby(['churn','userId']).agg(count(col('page')).alias('ThumbsUps')).orderBy('churn')\\\n",
    "    .toPandas()\n",
    "fig, ax = plt.subplots(figsize=(10, 7))\n",
    "plt.style.use('ggplot') \n",
    "thumbsUp.hist('ThumbsUps', by='churn', color = \"purple\", bins=20, ax=ax, density=5)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<AxesSubplot:>"
      ]
     },
     "execution_count": 22,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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eOKJWbFiRe6///7069cv69aty4gRI3LVVVelpqZmr2OuXbs23/jGN9LS0pKhQ4fmiiuuyJo1a/Lwww+ntrY2y5cvz/XXX9+x/TPPPJM1a9bk4osvziOPPJJHHnkk8+fPz8aNGzN//vzccMMNSZJHH300zz33XFpbWzNz5swMHz48O3bsyMKFC9PY2JhevXrl8ssvzzHHHPOW67G/53zbbbflox/9aE477bQkyYIFC/Jbv/VbGTduXO6+++6sXLkyr776aqZMmZKzzz57X3/vAAD4NbVPkT1x4sQ88MADOe200/Liiy9m0qRJHZH9ne98J6ecckqmT5+enTt35jOf+Uw+9KEPpX///vnsZz+bww47LBs2bMiXv/zljtstXnjhhXzpS1/KwIED87nPfS4/+9nPMnLkyL2OOX/+/Fx66aU56aSTcu+99+aBBx7IJZdckrPPPju9e/fO7//+7++1fUNDQ/7lX/4lSbJq1ar069cvmzdvzqpVq9LQ0NCxXb9+/fKFL3whjz32WBYtWpQ///M/z3333Zfjjjsu1157bZYvX5758+fn5ptvfsv12N9zPv300/P000/ntNNOS2tra5YvX55PfvKT+bd/+7f06dMnN954Y1599dV87nOfy6mnnpohQ4bsdbwf/OAH+cEPfpAkblkBOMAGDx7cKcepq6vrtGPxGmve+brzmu9TZB9zzDF55ZVX8tRTT2X06NF7vbZs2bI899xzWbRoUZJkz549aWpqyqBBg3LHHXdk7dq1qa2tzYYNGzr2Of7441NfX58kOfbYY9PY2LhXZO/atSs7d+7MSSedlCQ544wzcuutt77tjAMGDEhzc3N2796dTZs2ZeLEiVm5cmVWr16dcePGdWw3fvz4JMmIESPy4x//OEmyevXqzJo1K0lyyimnZMeOHdm1a1f69Onzpsfa33MeNWpU7rzzzrz66qt5/vnn09DQkMMOOyw/+clP8j//8z/50Y9+1HHeGzZseENkT548OZMnT37b8wegjKampk45zuDBgzvtWLzGmne+Q33Nhw0b9pav7VNkJ8mYMWPy7W9/O5///Oezffv2juerqsqsWbPecJD77rsv/fv3z80335yqqvKJT3yi47WePXt2/Lq2tjbt7e37Osbb+uAHP5jFixdn2LBhaWhoyOLFi7NmzZpcdNFFHdvU1dV1HLetre1dHWd/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\n",
      "text/plain": [
       "<Figure size 792x504 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# the mean of ThumbsUp for who stay and the mean of ThumbsUp for who leave\n",
    "fig, ax = plt.subplots(figsize=(11, 7))\n",
    "plt.style.use('ggplot') \n",
    "sparkDf = pd.DataFrame({'': [\"Mean of who stay\", \"Mean of who leave\"], 'Mean': [thumbsUp[thumbsUp['churn']==False]['ThumbsUps'].mean(), thumbsUp[thumbsUp['churn']==True]['ThumbsUps'].mean()]})\n",
    "sparkDf.plot.barh(x='', y='Mean', color='black', ax=ax)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<AxesSubplot:>"
      ]
     },
     "execution_count": 23,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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rMnVV1/dcfzjjz+eDRs25Nxzz82SJUuyZMmSNDc358UXX0xzc3OuueaaJMlPf/rTrFq1Km1tbZk9e3aGDh2aHTt2ZP78+dmyZUt69uyZGTNm5PDDD3/b9ejsPd944435/Oc/nxNOOCFJcsstt+T3fu/3cuKJJ+Zf/uVf8tRTT+X111/P5MmTc8YZZ7zXvzsAgJr1niJ0woQJWbRoUU444YQ8++yzmThxYkeE3nvvvTn22GMzc+bM7Ny5M1deeWWOO+649OvXL9/61rfSo0ePbN68OTfddFPHy9kbN27M97///fTv3z9XXXVVnn766YwYMWK/azY3N+f888/PyJEjc/fdd2fRokU577zzcsYZZ6RXr1754he/uN/xTU1N+clPfpIkWbduXfr27Zvt27dn3bp1aWpq6jiub9++ue6667J06dIsXrw4F154YRYuXJgjjzwyl112WdasWZPm5ubccMMNb7senb3nk08+OStWrMgJJ5yQtra2rFmzJtOnT88jjzyS3r1753vf+15ef/31XHXVVRk1alQGDRq03/UefvjhPPzww0niLQEAFDdw4MBqj/Ch0dDQYD0OkPcUoYcffnheeumlLF++PGPGjNnvuSeffDKrVq3K4sWLkyR79+7N1q1bM2DAgNx222155plnUl9fn82bN3ecM3z48DQ2NiZJjjjiiGzZsmW/CN21a1d27tyZkSNHJklOPfXUzJs37x1nPOSQQ9La2prdu3dn27ZtmTBhQp566qmsX78+J554Ysdx48ePT5IMGzYsv/zlL5Mk69evz5w5c5Ikxx57bHbs2JFdu3ald+/eb3mtzt7z6NGjc/vtt+f111/PE088kaampvTo0SO/+tWv8n//93/5z//8z4773rx585sidNKkSZk0adI73j8AfFC2bt1a7RE+NAYOHGg9OmHIkCFv+9x7itAkGTt2bO6888585zvfyWuvvdbxeKVSyZw5c950kYULF6Zfv3654YYbUqlU8tWvfrXjue7du3f8ub6+Pu3t7e91jHd01FFH5dFHH82QIUPS1NSURx99NBs2bMjXvva1jmMaGho6rrtv3773dZ3O3nOPHj1yzDHH5Fe/+lVWrFiRCRMmdPyev/zLv8zo0aPf1xwAALXqPX9F08SJEzN16tQcdthh+z0+atSoPPjgg6lUKkneeKk9eWNXr3///qmvr8+y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v/3tb1NXV5dJkyZlypQp1R6r5rS3t+eKK67IgAEDfE3J+7Bz584sWLAgLS0tqaury0UXXZSjjjqq2mPVjH/7t3/LI488krq6unzmM5/JzJkz06NHj2qP9aE2f/78rF69Ov369cvcuXOTJDt27Mi8efPy0ksv5ZOf/GT++q//On369KnypB9Ob7V+d955Z1atWpWGhoYMHjw4M2fOzCc+8YkqT1qb7ITWiPb29tx222258sorM2/evCxfvjzPPfdctceqGd26dctf/MVfZN68efnbv/3bLF261Pq9D0uWLMnQoUOrPUbNuv322zN69OjceOONueGGG6xlJ2zfvj0PPvhgrr322sydOzft7e1ZsWJFtcf60PvCF76QK6+8cr/H7rvvvhx33HG5+eabc9xxx+W+++6rznA14K3W7/jjj8/cuXPz93//9/nUpz6VH//4x1WarvaJ0Brx3//93zn00EMzePDgNDQ05OSTT87KlSurPVbN6N+/f4YNG5YkOeiggzJ06NBs3769ylPVlm3btmX16tU5/fTTqz1KTdq1a1fWrVuX0047LUnS0NBg96ST2tvbs3fv3uzbty979+5N//79qz3Sh97IkSPftMu5cuXKnHrqqUmSU0891X9L3sFbrd+oUaPSrVu3JMlRRx3lvyVd4OX4GrF9+/Y0NjZ2/NzY2Jjf/OY3VZyodm3ZsiUbN27M8OHDqz1KTbnjjjvy53/+59m9e3e1R6lJW7ZsycEHH5z58+fn2WefzbBhw3LeeeelV69e1R6tJgwYMCB/+Id/mIsuuig9evTIqFGjMmrUqGqPVZNeeeWVjoA/5JBD8sorr1R5otr1yCOP5OSTT672GDXLTigfK62trZk7d27OO++89O7du9rj1IxVq1alX79+HbvJdN6+ffuycePGnHnmmbn++uvTs2dPL4N2wo4dO7Jy5crccsst+cd//Me0trZm2bJl1R6r5tXV1aWurq7aY9Ske++9N926dcspp5xS7VFqlgitEQMGDMi2bds6ft62bVsGDBhQxYlqT1tbW+bOnZtTTjkl48ePr/Y4NeXpp5/Of/3Xf2XWrFm58cYbs2bNmtx8883VHqumNDY2prGxMZ/73OeSJCeddFI2btxY5alqx69//esMGjQoBx98cBoaGjJ+/Phs2LCh2mPVpH79+uXll19Okrz88ss5+OCDqzxR7XnssceyatWqXHzxxSK+C0RojfjsZz+bzZs3Z8uWLWlra8uKFSsyduzYao9VMyqVShYsWJChQ4fmD/7gD6o9Ts35yle+kgULFuSWW27JN77xjRx77LG5+OKLqz1WTTnkkEPS2NiYTZs2JXkjqj796U9XearaMXDgwPzmN7/Jnj17UqlU8utf/9oHu96nsWPH5uc//3mS5Oc//3nGjRtX5YlqyxNPPJH7778/l19+eXr27FntcWqafzGphqxevTr//M//nPb29kycODFnn312tUeqGevXr8+3v/3tHHbYYR3/1/pnf/ZnOeGEE6o8We1Zu3ZtFi9e7Cua3odnnnkmCxYsSFtbWwYNGpSZM2f6apxOWLhwYVasWJFu3brliCOOyIUXXpju3btXe6wPtRtvvDFPPfVUXnvttfTr1y/Tpk3LuHHjMm/evGzdutVXNL2Lt1q/H//4x2lra+tYs8997nOZMWNGlSetTSIUAIDivBwPAEBxIhQAgOJEKAAAxYlQAACKE6EAABQnQgEAKE6EAgBQ3P8DZmuUhcFZR20AAAAASUVORK5CYII=\n",
      "text/plain": [
       "<Figure size 720x504 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# the mean of ThumbsDown for who stay and the mean of ThumbsDown for who leave\n",
    "counColDown = count(col('page')).alias('ThumbsDowns')\n",
    "thumbsDown = itsChurn.where(itsChurn.page=='Thumbs Down').groupby(['churn','userId']).agg(counColDown).orderBy('churn').toPandas()\n",
    "fig, ax = plt.subplots(figsize=(10, 7))\n",
    "plt.style.use('ggplot') \n",
    "sparkDf = pd.DataFrame({'': [\"Mean of who stay\", \"Mean of who leave\"], 'Mean': [thumbsDown[thumbsDown['churn']==False]['ThumbsDowns'].mean(), thumbsDown[thumbsDown['churn']==True]['ThumbsDowns'].mean()]})\n",
    "sparkDf.plot.barh(x='', y='Mean', color='teal', ax=ax)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "+-----------------+\n",
      "|count(songPlayed)|\n",
      "+-----------------+\n",
      "|            44864|\n",
      "+-----------------+\n",
      "\n",
      "+-----------------+\n",
      "|count(songPlayed)|\n",
      "+-----------------+\n",
      "|           233290|\n",
      "+-----------------+\n",
      "\n"
     ]
    }
   ],
   "source": [
    "# the number of songs that played from churned users and not churned users\n",
    "itsChurn = itsChurn.withColumn('date', udf(lambda x: datetime.datetime.fromtimestamp(x/1000), DateType())(col('ts')))\n",
    "churn = itsChurn.filter(col('churn')==1).withColumn('songPlayed', udf(lambda x : int(x=='NextSong'), IntegerType())(col('page')))\n",
    "notChurn = itsChurn.filter(col('churn')==0).withColumn('songPlayed', udf(lambda x : int(x=='NextSong'), IntegerType())(col('page')))\n",
    "\n",
    "countChurn = churn.agg({'songPlayed':'count'}).show()\n",
    "countNotChurn = notChurn.agg({'songPlayed':'count'}).show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "+------------------+\n",
      "|   avg(songPlayed)|\n",
      "+------------------+\n",
      "|0.8112072039942939|\n",
      "+------------------+\n",
      "\n",
      "+------------------+\n",
      "|   avg(songPlayed)|\n",
      "+------------------+\n",
      "|0.8217840456084702|\n",
      "+------------------+\n",
      "\n"
     ]
    }
   ],
   "source": [
    "# the mean of songs that played from churned users and not churned users\n",
    "meanChurn = churn.agg({'songPlayed':'mean'}).show()\n",
    "meanNotChurn = notChurn.agg({'songPlayed':'mean'}).show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "+-------+------------------+\n",
      "|summary|       count(page)|\n",
      "+-------+------------------+\n",
      "|  count|                31|\n",
      "|   mean| 1.032258064516129|\n",
      "| stddev|0.1796053020267749|\n",
      "|    min|                 1|\n",
      "|    max|                 2|\n",
      "+-------+------------------+\n",
      "\n"
     ]
    }
   ],
   "source": [
    "# the number of songs that are not played because of an error occurred ( churn )\n",
    "cChurnTs = itsChurn.filter((itsChurn.page =='Error') & (itsChurn.churn == 1)).select('userId', 'page', 'ts', 'length')\\\n",
    "    .withColumn('date', udf(lambda x: datetime.datetime.fromtimestamp(x/1000), DateType())(col('ts'))).groupBy('userId', 'date')\\\n",
    "    .agg({'page':'count'}).select('count(page)').describe().show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "+-------+------------------+\n",
      "|summary|       count(page)|\n",
      "+-------+------------------+\n",
      "|  count|               199|\n",
      "|   mean|1.1055276381909547|\n",
      "| stddev| 0.323989646283549|\n",
      "|    min|                 1|\n",
      "|    max|                 3|\n",
      "+-------+------------------+\n",
      "\n"
     ]
    }
   ],
   "source": [
    "# the number of songs that are not played because of an error occurred ( not churn )\n",
    "nChurnTs =  itsChurn.filter((itsChurn.page =='Error') & (itsChurn.churn == 0)).select('userId', 'page', 'ts', 'length')\\\n",
    "    .withColumn('date', udf(lambda x: datetime.datetime.fromtimestamp(x/1000), DateType())(col('ts'))).groupBy('userId', 'date')\\\n",
    "    .agg({'page':'count'}).select('count(page)').describe().show()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Feature Engineering\n",
    "Once you've familiarized yourself with the data, build out the features you find promising to train your model on. To work with the full dataset, you can follow the following steps.\n",
    "- Write a script to extract the necessary features from the smaller subset of data\n",
    "- Ensure that your script is scalable, using the best practices discussed in Lesson 3\n",
    "- Try your script on the full data set, debugging your script if necessary\n",
    "\n",
    "If you are working in the classroom workspace, you can just extract features based on the small subset of data contained here. Be sure to transfer over this work to the larger dataset when you work on your Spark cluster."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "+-------+------------------+------------------+\n",
      "|summary|            userId|            gender|\n",
      "+-------+------------------+------------------+\n",
      "|  count|               225|               225|\n",
      "|   mean|65391.013333333336|0.4622222222222222|\n",
      "| stddev|105396.47791907164|0.4996824388374477|\n",
      "|    min|                10|                 0|\n",
      "|    max|                99|                 1|\n",
      "+-------+------------------+------------------+\n",
      "\n",
      "+------+------+\n",
      "|userId|gender|\n",
      "+------+------+\n",
      "|    10|     0|\n",
      "|   100|     0|\n",
      "|100001|     1|\n",
      "|100002|     1|\n",
      "|100003|     1|\n",
      "|100004|     1|\n",
      "|100005|     0|\n",
      "|100006|     1|\n",
      "|100007|     1|\n",
      "|100008|     1|\n",
      "|100009|     0|\n",
      "|100010|     1|\n",
      "|100011|     0|\n",
      "|100012|     0|\n",
      "|100013|     1|\n",
      "|100014|     0|\n",
      "|100015|     1|\n",
      "|100016|     0|\n",
      "|100017|     0|\n",
      "|100018|     0|\n",
      "+------+------+\n",
      "only showing top 20 rows\n",
      "\n"
     ]
    }
   ],
   "source": [
    "# replace gender from (M , F) to (1 , 0)\n",
    "gender = itsChurn.dropDuplicates(['userId']).sort('userId').select(['userId','gender'])\\\n",
    "    .replace(['F','M'], ['1', '0'], 'gender')\n",
    "\n",
    "gender.withColumn('gender', gender.gender.cast(\"int\")).describe().show()\n",
    "gender.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "+------+------------------+\n",
      "|userId|  registrationDays|\n",
      "+------+------------------+\n",
      "|100010| 55.64365740740741|\n",
      "|200002| 70.07462962962963|\n",
      "|   125| 71.31688657407408|\n",
      "|    51|19.455844907407407|\n",
      "|   124|131.55591435185184|\n",
      "|     7| 72.77818287037037|\n",
      "|    54|110.75168981481481|\n",
      "|    15|56.513576388888886|\n",
      "|   155|23.556018518518517|\n",
      "|   132|  66.8891087962963|\n",
      "|   154|23.872037037037035|\n",
      "|100014| 85.08340277777778|\n",
      "|   101|        53.9659375|\n",
      "|    11|124.47825231481481|\n",
      "|   138| 66.62668981481481|\n",
      "|300017| 74.35851851851852|\n",
      "|    29|60.104050925925925|\n",
      "|    69| 71.42444444444445|\n",
      "|100021| 64.73886574074074|\n",
      "|    42| 67.11364583333334|\n",
      "+------+------------------+\n",
      "only showing top 20 rows\n",
      "\n"
     ]
    }
   ],
   "source": [
    "# the total number of days beginning from registration day \n",
    "sUserDay = itsChurn.groupby(\"userId\").max(\"ts\").sort(\"userId\")\n",
    "sDupuUserDay = itsChurn.select(\"userId\", \"registration\").dropDuplicates().sort(\"userId\")\n",
    "registration = (sUserDay[\"max(ts)\"] - sDupuUserDay[\"registration\"])/(1000*60*60*24)\n",
    "userRegistration = sDupuUserDay.join(sUserDay, sDupuUserDay.userId == sUserDay.userId)\\\n",
    "    .select(sDupuUserDay[\"userId\"], registration.alias(\"registrationDays\")).show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "+------+-----------+\n",
      "|userId|SongsPlayed|\n",
      "+------+-----------+\n",
      "|    10|        673|\n",
      "|   100|       2682|\n",
      "|100001|        133|\n",
      "|100002|        195|\n",
      "|100003|         51|\n",
      "|100004|        942|\n",
      "|100005|        154|\n",
      "|100006|         26|\n",
      "|100007|        423|\n",
      "|100008|        772|\n",
      "|100009|        518|\n",
      "|100010|        275|\n",
      "|100011|         11|\n",
      "|100012|        476|\n",
      "|100013|       1131|\n",
      "|100014|        257|\n",
      "|100015|        800|\n",
      "|100016|        530|\n",
      "|100017|         52|\n",
      "|100018|       1002|\n",
      "+------+-----------+\n",
      "only showing top 20 rows\n",
      "\n"
     ]
    }
   ],
   "source": [
    "# the total number of song that was played \n",
    "songsPlayedAgr = itsChurn.where(itsChurn.song != 'null').groupby('userId').agg(count(itsChurn.song).alias('SongsPlayed'))\n",
    "songsPlayedOrd = songsPlayedAgr.orderBy('userId')\n",
    "selSongsPlayed = songsPlayedOrd.select(['userId','SongsPlayed']).show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "+------+------------------+\n",
      "|userId|   avgSessionSongs|\n",
      "+------+------------------+\n",
      "|    10|112.16666666666667|\n",
      "|   100| 78.88235294117646|\n",
      "|100001|             33.25|\n",
      "|100002|             48.75|\n",
      "|100003|              25.5|\n",
      "|100004|              47.1|\n",
      "|100005|              38.5|\n",
      "|100006|              26.0|\n",
      "|100007|              47.0|\n",
      "|100008|128.66666666666666|\n",
      "|100009|              51.8|\n",
      "|100010|39.285714285714285|\n",
      "|100011|              11.0|\n",
      "|100012| 79.33333333333333|\n",
      "|100013|              87.0|\n",
      "|100014|42.833333333333336|\n",
      "|100015| 66.66666666666667|\n",
      "|100016|             66.25|\n",
      "|100017|              52.0|\n",
      "|100018|              50.1|\n",
      "+------+------------------+\n",
      "only showing top 20 rows\n",
      "\n"
     ]
    }
   ],
   "source": [
    "# the total number of song for each session\n",
    "songSessionCount = itsChurn.filter(itsChurn.page == \"NextSong\").groupby(\"userId\", \"sessionId\").count()\n",
    "avgs = avg(songSessionCount[\"count\"])\n",
    "sSessionSongs = songSessionCount.groupby(\"userId\").agg(avgs.alias(\"avgSessionSongs\")).sort(\"userId\").show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "+-------+------------------+------------------+\n",
      "|summary|            userId|      sessionCount|\n",
      "+-------+------------------+------------------+\n",
      "|  count|               225|               225|\n",
      "|   mean|65391.013333333336|14.115555555555556|\n",
      "| stddev|105396.47791907164| 14.64688465711156|\n",
      "|    min|                10|                 1|\n",
      "|    max|                99|               107|\n",
      "+-------+------------------+------------------+\n",
      "\n",
      "+------+------------+\n",
      "|userId|sessionCount|\n",
      "+------+------------+\n",
      "|    10|           6|\n",
      "|   100|          35|\n",
      "|100001|           4|\n",
      "|100002|           4|\n",
      "|100003|           2|\n",
      "|100004|          21|\n",
      "|100005|           5|\n",
      "|100006|           1|\n",
      "|100007|           9|\n",
      "|100008|           6|\n",
      "|100009|          10|\n",
      "|100010|           7|\n",
      "|100011|           1|\n",
      "|100012|           7|\n",
      "|100013|          14|\n",
      "|100014|           6|\n",
      "|100015|          12|\n",
      "|100016|           8|\n",
      "|100017|           1|\n",
      "|100018|          21|\n",
      "+------+------------+\n",
      "only showing top 20 rows\n",
      "\n"
     ]
    }
   ],
   "source": [
    "# the total number of session for each user\n",
    "userSGro =  itsChurn.select(\"userId\", \"sessionId\").dropDuplicates().groupby(\"userId\").count()\n",
    "userSession = userSGro.withColumnRenamed(\"count\", \"sessionCount\").sort('userID')\n",
    "userSession.describe().show()\n",
    "userSession.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "+-------+------------------+------------------+\n",
      "|summary|            userId|    avgSessionTime|\n",
      "+-------+------------------+------------------+\n",
      "|  count|               225|               225|\n",
      "|   mean|65391.013333333336| 288.1659840733498|\n",
      "| stddev|105396.47791907164|176.84244472357116|\n",
      "|    min|                10|               7.0|\n",
      "|    max|                99|            1179.9|\n",
      "+-------+------------------+------------------+\n",
      "\n",
      "+------+------------------+\n",
      "|userId|    avgSessionTime|\n",
      "+------+------------------+\n",
      "|    10|459.74722222222226|\n",
      "|   100| 316.5190476190476|\n",
      "|100001|148.15833333333333|\n",
      "|100002|201.18333333333334|\n",
      "|100003| 99.11666666666667|\n",
      "|100004|185.98650793650793|\n",
      "|100005|120.18666666666668|\n",
      "|100006| 93.43333333333334|\n",
      "|100007|189.41111111111113|\n",
      "|100008| 528.2527777777779|\n",
      "|100009|211.96166666666667|\n",
      "|100010|154.48333333333332|\n",
      "|100011| 44.38333333333333|\n",
      "|100012|271.43809523809523|\n",
      "|100013|329.99880952380954|\n",
      "|100014| 184.8138888888889|\n",
      "|100015|278.59444444444443|\n",
      "|100016|265.40416666666664|\n",
      "|100017|199.26666666666668|\n",
      "|100018|193.18730158730162|\n",
      "+------+------------------+\n",
      "only showing top 20 rows\n",
      "\n"
     ]
    }
   ],
   "source": [
    "# the average time that taken for each session\n",
    "sessionTime = itsChurn.groupby(\"userId\", \"sessionId\")\n",
    "session = (max(itsChurn.ts) -  min(itsChurn.ts))/(1000*60)\n",
    "session = session.alias(\"sessionTime\")\n",
    "sessionTimeAgr = sessionTime.agg(session)\n",
    "avgSession = avg(sessionTimeAgr.sessionTime).alias(\"avgSessionTime\")\n",
    "sAvgSessionTime =  itsChurn.groupby(\"userId\", \"sessionId\").agg(session).groupby(\"userId\").agg(avgSession).sort(\"userId\")\n",
    "sAvgSessionTime.describe().show()\n",
    "sAvgSessionTime.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "+-------+------------------+-----------------+\n",
      "|summary|            userId|  SingersListened|\n",
      "+-------+------------------+-----------------+\n",
      "|  count|               225|              225|\n",
      "|   mean|65391.013333333336|696.3777777777777|\n",
      "| stddev|105396.47791907164|603.9518698630803|\n",
      "|    min|                10|                3|\n",
      "|    max|                99|             3544|\n",
      "+-------+------------------+-----------------+\n",
      "\n",
      "+------+---------------+\n",
      "|userId|SingersListened|\n",
      "+------+---------------+\n",
      "|    10|            565|\n",
      "|   100|           1705|\n",
      "|100001|            125|\n",
      "|100002|            184|\n",
      "|100003|             50|\n",
      "|100004|            733|\n",
      "|100005|            149|\n",
      "|100006|             26|\n",
      "|100007|            357|\n",
      "|100008|            623|\n",
      "|100009|            442|\n",
      "|100010|            252|\n",
      "|100011|             11|\n",
      "|100012|            397|\n",
      "|100013|            826|\n",
      "|100014|            233|\n",
      "|100015|            627|\n",
      "|100016|            431|\n",
      "|100017|             51|\n",
      "|100018|            780|\n",
      "+------+---------------+\n",
      "only showing top 20 rows\n",
      "\n"
     ]
    }
   ],
   "source": [
    "# the number of singer that the user was listened\n",
    "singerAgr = itsChurn.dropDuplicates(['userId','artist']).groupby('userId').agg( count(itsChurn.artist)\\\n",
    "            .alias('SingersListened')).orderBy('userId')\n",
    "singerAgr.select(['userId','SingersListened'])\n",
    "singerAgr.describe().show()\n",
    "singerAgr.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "+-------+------------------+------------------+\n",
      "|summary|            userId|        numFriends|\n",
      "+-------+------------------+------------------+\n",
      "|  count|               206|               206|\n",
      "|   mean| 66076.91262135922|20.762135922330096|\n",
      "| stddev|106860.60517425009| 20.64677907440501|\n",
      "|    min|                10|                 1|\n",
      "|    max|                99|               143|\n",
      "+-------+------------------+------------------+\n",
      "\n",
      "+------+----------+\n",
      "|userId|numFriends|\n",
      "+------+----------+\n",
      "|    10|        12|\n",
      "|   100|        49|\n",
      "|100001|         2|\n",
      "|100002|         1|\n",
      "|100004|        19|\n",
      "|100005|         3|\n",
      "|100006|         4|\n",
      "|100007|        17|\n",
      "|100008|        17|\n",
      "|100009|         7|\n",
      "|100010|         4|\n",
      "|100012|         2|\n",
      "|100013|        28|\n",
      "|100014|         6|\n",
      "|100015|        14|\n",
      "|100016|        13|\n",
      "|100018|        23|\n",
      "|100019|         2|\n",
      "|100021|         7|\n",
      "|100022|        11|\n",
      "+------+----------+\n",
      "only showing top 20 rows\n",
      "\n"
     ]
    }
   ],
   "source": [
    "# the total Number of friends for each user\n",
    "userFriendGro = itsChurn.filter(itsChurn.page=='Add Friend').select('userId', 'page').groupBy('userId')\n",
    "renamedCountFriend = userFriendGro.count().withColumnRenamed('count', 'numFriends').sort('userId')\n",
    "renamedCountFriend.describe().show()\n",
    "renamedCountFriend.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Modeling\n",
    "Split the full dataset into train, test, and validation sets. Test out several of the machine learning methods you learned. Evaluate the accuracy of the various models, tuning parameters as necessary. Determine your winning model based on test accuracy and report results on the validation set. Since the churned users are a fairly small subset, I suggest using F1 score as the metric to optimize."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<AxesSubplot:xlabel='churn', ylabel='count'>"
      ]
     },
     "execution_count": 31,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 720x504 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# the total number of churn and not churn\n",
    "users = itsChurn.dropDuplicates(['userId'])\n",
    "sUsers = users.sort('userId')\n",
    "selUsers = sUsers.select(['userId','churn'])\n",
    "\n",
    "for x in [gender, userRegistration, selSongsPlayed, sAvgSessionTime, singerAgr, sSessionSongs, userSession, renamedCountFriend]:\n",
    "    selUsers = selUsers.join(x,'userId')\n",
    "    \n",
    "usersGro = selUsers.groupby(\"churn\")\n",
    "countUsers = usersGro.count()\n",
    "userz = countUsers.toPandas()\n",
    "dims = (10, 7)\n",
    "fig, ax = plt.subplots(figsize=dims)\n",
    "plt.style.use('fivethirtyeight') \n",
    "sns.barplot(x=\"churn\", y=\"count\", ax=ax, data=userz)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[('userId', 'string'),\n",
       " ('churn', 'boolean'),\n",
       " ('gender', 'string'),\n",
       " ('registrationDays', 'double'),\n",
       " ('SongsPlayed', 'bigint'),\n",
       " ('avgSessionTime', 'double'),\n",
       " ('SingersListened', 'bigint'),\n",
       " ('avgSessionSongs', 'double'),\n",
       " ('sessionCount', 'bigint'),\n",
       " ('numFriends', 'bigint')]"
      ]
     },
     "execution_count": 32,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# data types\n",
    "selUsers.dtypes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "DataFrame[summary: string, userId: string, gender: string, registrationDays: string, SongsPlayed: string, avgSessionTime: string, SingersListened: string, avgSessionSongs: string, sessionCount: string, numFriends: string]"
      ]
     },
     "execution_count": 33,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# general details\n",
    "selUsers.describe()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "+------+-----+------+------------------+-----------+------------------+---------------+------------------+------------+----------+\n",
      "|userId|churn|gender|  registrationDays|SongsPlayed|    avgSessionTime|SingersListened|   avgSessionSongs|sessionCount|numFriends|\n",
      "+------+-----+------+------------------+-----------+------------------+---------------+------------------+------------+----------+\n",
      "|    10|false|     0| 51.76265046296297|        673|459.74722222222226|            565|112.16666666666667|           6|        12|\n",
      "|   100|false|     0| 64.87377314814815|       2682| 316.5190476190476|           1705| 78.88235294117646|          35|        49|\n",
      "|100001| true|     1| 44.80021990740741|        133|148.15833333333333|            125|             33.25|           4|         2|\n",
      "|100002|false|     1|160.47207175925925|        195|201.18333333333334|            184|             48.75|           4|         1|\n",
      "|100004|false|     1|172.44008101851853|        942|185.98650793650793|            733|              47.1|          21|        19|\n",
      "+------+-----+------+------------------+-----------+------------------+---------------+------------------+------------+----------+\n",
      "only showing top 5 rows\n",
      "\n"
     ]
    }
   ],
   "source": [
    "# show the data\n",
    "selUsers.show(5)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "metadata": {},
   "outputs": [],
   "source": [
    "features = selUsers.columns[1:]\n",
    "for x in features:\n",
    "    name = x + \"Num\"\n",
    "    selUsers = selUsers.withColumn(name, selUsers[x].cast(\"float\"))\n",
    "    selUsers = selUsers.drop(x)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "metadata": {},
   "outputs": [],
   "source": [
    "# transforming, selecting features and scale\n",
    "cols = selUsers.columns[2:]\n",
    "VA = VectorAssembler(inputCols = cols, outputCol=\"NumFeatures\")\n",
    "resultsDF = VA.transform(selUsers)\n",
    "SS = StandardScaler(inputCol=\"NumFeatures\", outputCol=\"ScaledNumFeatures\", withStd=True)\n",
    "sModel = SS.fit(resultsDF)\n",
    "results = sModel.transform(resultsDF)\n",
    "label = results.churnNum.alias(\"label\")\n",
    "features = results.ScaledNumFeatures.alias(\"features\")\n",
    "results = results.select(label, features)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "metadata": {},
   "outputs": [],
   "source": [
    "# split data randomlay then use sampleBy to returns stratified sample without replacement by the fraction\n",
    "fraction = {0: 99/349, 1: 1.0}\n",
    "rang = [0.9, 0.1]\n",
    "train, validation = results.randomSplit(rang, seed=42)\n",
    "train = train.cache()\n",
    "sTrain = train.sampleBy('label', fractions=fraction)\n",
    "sTrain = sTrain.cache()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 38,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "LogisticRegressionModel: uid=LogisticRegression_7fdc81d10916, numClasses=2, numFeatures=8"
      ]
     },
     "execution_count": 38,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# create LogisticRegression model and build ParamGrid then use cross validation\n",
    "log_model =  LogisticRegression()\n",
    "param = ParamGridBuilder()\n",
    "addGrid = param.addGrid(log_model.elasticNetParam,[0.0, 0.1, 0.5, 1.0])\n",
    "builder = addGrid.addGrid(log_model.regParam,[0.0, 0.05, 0.1])\n",
    "builder = builder.build()\n",
    "cValidation = CrossValidator(estimator = log_model, estimatorParamMaps = builder, \n",
    "                          evaluator= MulticlassClassificationEvaluator(), numFolds = 3)\n",
    "log_model = cValidation.fit(sTrain)\n",
    "\n",
    "log_model.bestModel"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 39,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Precision: 0.5\n",
      "Recall: 0.5\n",
      "Accuracy: 0.7142857142857143\n",
      "F1-score: 0.5\n"
     ]
    }
   ],
   "source": [
    "# the results by using Accuracy, Precision, Recall, and F1-score\n",
    "trans = log_model.transform(validation)\n",
    "TP = trans.filter(\"label = 1 and prediction = 1\")\n",
    "TP = TP.count()\n",
    "FP = trans.filter(\"label = 0 and prediction = 1\")\n",
    "FP = FP.count()\n",
    "FN = trans.filter(\"label = 1 and prediction = 0\")\n",
    "FN = FN.count()\n",
    "TN = trans.filter(\"label = 0 and prediction = 0\")\n",
    "TN = TN.count()\n",
    "\n",
    "precision = TP / (TP + FN) \n",
    "print(\"Precision:\", precision)\n",
    "\n",
    "recall = TP / (TP + FN)\n",
    "print(\"Recall:\", recall)\n",
    "\n",
    "accuracy = (TP + TN) / (TP + FP + TN + FN)\n",
    "print(\"Accuracy:\", accuracy)\n",
    "\n",
    "f1_score = 2*precision*recall / ( precision + recall)\n",
    "print(\"F1-score:\", f1_score)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 40,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "DecisionTreeClassificationModel: uid=DecisionTreeClassifier_9587b1d635fa, depth=2, numNodes=5, numClasses=2, numFeatures=8"
      ]
     },
     "execution_count": 40,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# create Decision Tree model and build ParamGrid then use cross validation\n",
    "dTree = DecisionTreeClassifier()\n",
    "param = ParamGridBuilder()\n",
    "addGrid = param.addGrid(dTree.impurity,['entropy', 'gini'])\n",
    "builder = addGrid.addGrid(dTree.maxDepth,[2, 3, 4, 5, 6, 7, 8])\n",
    "builder = builder.build()\n",
    "cValidation = CrossValidator(estimator = dTree, estimatorParamMaps = builder,\n",
    "                          evaluator = MulticlassClassificationEvaluator(), numFolds = 3)\n",
    "dTree_model = cValidation.fit(train)\n",
    "\n",
    "dTree_model.bestModel"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 41,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Precision: 0.5\n",
      "Recall: 0.5\n",
      "Accuracy: 0.7142857142857143\n",
      "F1-score: 0.5\n"
     ]
    }
   ],
   "source": [
    "# the results by using Accuracy, Precision, Recall, and F1-score\n",
    "trans = log_model.transform(validation)\n",
    "TP = trans.filter(\"label = 1 and prediction = 1\")\n",
    "TP = TP.count()\n",
    "FP = trans.filter(\"label = 0 and prediction = 1\")\n",
    "FP = FP.count()\n",
    "FN = trans.filter(\"label = 1 and prediction = 0\")\n",
    "FN = FN.count()\n",
    "TN = trans.filter(\"label = 0 and prediction = 0\")\n",
    "TN = TN.count()\n",
    "\n",
    "precision = TP / (TP + FN) \n",
    "print(\"Precision: \", precision)\n",
    "\n",
    "recall = TP / (TP + FN)\n",
    "print(\"Recall: \", recall)\n",
    "\n",
    "accuracy = (TP + TN) / (TP + FP + TN + FN)\n",
    "print(\"Accuracy: \", accuracy)\n",
    "\n",
    "f1_score = 2*precision*recall / ( precision + recall)\n",
    "print(\"F1-score: \", f1_score)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Final Steps\n",
    "Clean up your code, adding comments and renaming variables to make the code easier to read and maintain. Refer to the Spark Project Overview page and Data Scientist Capstone Project Rubric to make sure you are including all components of the capstone project and meet all expectations. Remember, this includes thorough documentation in a README file in a Github repository, as well as a web app or blog post."
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.8"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
